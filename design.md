# Y!mobile Monitor - モバイルアプリ設計書

## アプリ概要

Y!mobileのマイページからデータ使用量を取得し、グラフで視覚的に表示するAndroidアプリです。既存のPythonスクレイピングロジックを移植し、ユーザーの認証情報を安全に保存して定期的にデータを更新します。

## 画面構成

### 1. **ログイン画面** (Login)
- Y!mobile IDとパスワードを入力
- 認証情報を安全に保存（Secure Store）
- ログイン状態を保持

### 2. **ホーム画面 - データ使用状況** (Dashboard)
- **メイン表示**
  - 円グラフ：使用率（使用量 / 総容量）
  - 棒グラフ：内訳（基本容量、繰越、使用済み）
  - テキスト表示：残量、使用量、総容量、使用率（%）
  
- **詳細情報セクション**
  - 基本容量（GB）
  - 繰越容量（GB）
  - 有料容量（GB）
  - 使用済み容量（GB）
  - 残量（GB）
  - 最終更新日時

- **操作ボタン**
  - 更新ボタン：最新データを取得
  - ログアウトボタン：セッション終了

### 3. **設定画面** (Settings)
- 認証情報の変更
- キャッシュ設定（更新間隔）
- 通知設定
- アプリ情報

## 主要ユーザーフロー

### フロー1：初回起動 → ログイン → データ表示
1. アプリ起動
2. ログイン画面表示
3. Y!mobile ID・パスワード入力
4. ログイン処理（Pythonロジック移植）
5. データ取得成功 → ホーム画面へ遷移
6. グラフ・テキストでデータ表示

### フロー2：データ更新
1. ホーム画面で「更新」ボタンをタップ
2. ローディング表示
3. 最新データ取得
4. グラフ・テキスト更新
5. 更新完了メッセージ表示

### フロー3：ログアウト
1. ホーム画面で「ログアウト」ボタンをタップ
2. 確認ダイアログ表示
3. ログイン画面に戻る

## データ構造

```typescript
interface MobileDataUsage {
  timestamp: string;              // ISO形式の日時
  remaining_gb: number;           // 残量（GB）
  total_gb: number;               // 総容量（GB）
  used_gb: number;                // 使用済み（GB）
  percentage: number;             // 使用率（%）
  last_updated: string;           // 最終更新日時（表示用）
  kurikoshi_gb: number;           // 繰越容量（GB）
  kihon_gb: number;               // 基本容量（GB）
  yuryou_gb: number;              // 有料容量（GB）
}
```

## 色設計

| 用途 | 色コード | 説明 |
|------|---------|------|
| プライマリ | #0066CC | Y!mobileブランドカラー（青） |
| 背景 | #FFFFFF (Light) / #1A1A1A (Dark) | 画面背景 |
| テキスト | #333333 (Light) / #FFFFFF (Dark) | 本文テキスト |
| グラフ - 使用済み | #FF6B6B | 赤系（警告色） |
| グラフ - 残量 | #51CF66 | 緑系（良好） |
| グラフ - 繰越 | #FFD93D | 黄系（追加） |
| グラフ - 基本 | #4ECDC4 | 青緑系（基本） |
| ボーダー | #E0E0E0 (Light) / #333333 (Dark) | 区切り線 |

## 技術実装ポイント

- **認証情報保存**：`expo-secure-store`を使用
- **グラフ表示**：`react-native-svg`と`react-native-reanimated`
- **データ取得**：PythonロジックをTypeScriptに移植
- **キャッシング**：AsyncStorageで15分間キャッシュ
- **エラーハンドリング**：ネットワークエラー、認証エラー、スクレイピング失敗時の処理

## セキュリティ考慮事項

- パスワードは`expo-secure-store`に暗号化保存
- ログイン状態をセッションで管理
- HTTPS通信（Y!mobileのマイページは既にHTTPS）
- キャッシュデータは暗号化して保存
